[nid003424:65406] shmem: mmap: an error occurred while determining whether or not /tmp/ompi.nid003424.105387/jf.0/642383872/shared_mem_cuda_pool.nid003424 could be created.
[nid003424:65406] create_and_attach: unable to create shared memory BTL coordinating structure :: size 134217728 
No PMIx server was reachable, but a PMI1/2 was detected.
If srun is being used to launch application,  2 singletons will be started.
[nid003421:92974] shmem: mmap: an error occurred while determining whether or not /tmp/ompi.nid003421.105387/jf.0/1665597440/shared_mem_cuda_pool.nid003421 could be created.
[nid003421:92974] create_and_attach: unable to create shared memory BTL coordinating structure :: size 134217728 
/global/homes/s/seanjx/.conda/envs/gigajax/lib/python3.12/site-packages/mpi4jax/_src/decorators.py:60: UserWarning: Not using CUDA-enabled MPI. If you are sure that your MPI library is built with CUDA support, set MPI4JAX_USE_CUDA_MPI=1. To silence this warning, set MPI4JAX_USE_CUDA_MPI=0.
  warnings.warn(warn_msg)
/global/homes/s/seanjx/.conda/envs/gigajax/lib/python3.12/site-packages/mpi4jax/_src/decorators.py:60: UserWarning: Not using CUDA-enabled MPI. If you are sure that your MPI library is built with CUDA support, set MPI4JAX_USE_CUDA_MPI=1. To silence this warning, set MPI4JAX_USE_CUDA_MPI=0.
  warnings.warn(warn_msg)
Process 1 global devices : [cuda(id=0), cuda(id=1), cuda(id=2), cuda(id=3), cuda(id=4), cuda(id=5), cuda(id=6), cuda(id=7)]
Process 1 local devices : [cuda(id=4), cuda(id=5), cuda(id=6), cuda(id=7)]
1722058142.9598372
Traceback (most recent call last):
  File "/global/homes/s/seanjx/gigalens/testetc/nanolens.py", line 96, in <module>
    np.save(path+"/err_map.npy",err_map)
  File "/global/homes/s/seanjx/.conda/envs/gigajax/lib/python3.12/site-packages/numpy/lib/npyio.py", line 542, in save
    file_ctx = open(file, "wb")
               ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'output/1722058142.9598372//err_map.npy'
Process 0 global devices : [cuda(id=0), cuda(id=1), cuda(id=2), cuda(id=3), cuda(id=4), cuda(id=5), cuda(id=6), cuda(id=7)]
Process 0 local devices : [cuda(id=0), cuda(id=1), cuda(id=2), cuda(id=3)]
1722058142.9548857
-0.016604776
62 (['EPL', 'SHEAR'], ['SERSIC_ELLIPSE', 'SERSIC_ELLIPSE', 'SERSIC_ELLIPSE', 'SERSIC_ELLIPSE', 'SERSIC_ELLIPSE'], ['SHAPELETS', 'SHAPELETS', 'SERSIC_ELLIPSE', 'SERSIC_ELLIPSE', 'SERSIC_ELLIPSE'])
4
(62, 4000)
(4000, 62)
(4, 1000, 62)
  0%|                                                                                                                                                                       | 0/50 [00:00<?, ?it/s]2024-07-26 22:29:23.880187: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng28{k2=3,k3=0} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:28.288217: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 5.408162566s
Trying algorithm eng28{k2=3,k3=0} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:29.288408: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng1{k2=4,k3=0} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:33.072295: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 4.784031706s
Trying algorithm eng1{k2=4,k3=0} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:34.072456: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng3{k11=0} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:34.078122: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.005790895s
Trying algorithm eng3{k11=0} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:35.078238: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng4{} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
2024-07-26 22:29:36.048735: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.97058424s
Trying algorithm eng4{} for conv (f32[1000,38,110,110]{3,2,1,0}, u8[0]{0}) custom-call(f32[1000,38,110,110]{3,2,1,0}, f32[38,1,27,27]{3,2,1,0}), window={size=27x27 pad=13_13x13_13}, dim_labels=bf01_oi01->bf01, feature_group_count=38, custom_call_target="__cudnn$convForward", backend_config={"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0} is taking a while...
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** STEP 28639210.0 ON nid003421 CANCELLED AT 2024-07-27T05:30:01 ***
slurmstepd: error: *** JOB 28639210 ON nid003421 CANCELLED AT 2024-07-27T05:30:01 ***
