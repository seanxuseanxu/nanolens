2024-08-06 18:02:44.902438: W external/xla/xla/service/gpu/nvptx_compiler.cc:765] The NVIDIA driver's CUDA version is 12.2 which is older than the ptxas CUDA version (12.5.82). Because the driver is older than the ptxas version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
2024-08-06 18:02:45.206235: W external/xla/xla/service/gpu/nvptx_compiler.cc:765] The NVIDIA driver's CUDA version is 12.2 which is older than the ptxas CUDA version (12.5.82). Because the driver is older than the ptxas version, XLA is disabling parallel compilation, which may slow down compilation. You should update your NVIDIA driver or use the NVIDIA-provided CUDA forward compatibility packages.
Process 1 global devices : [cuda(id=0), cuda(id=1), cuda(id=2), cuda(id=3)]
Process 1 local devices : [cuda(id=2), cuda(id=3)]
Process 1 rank: 1 out of 2
20 (['EPL', 'SHEAR'], ['SERSIC_ELLIPSE'], ['SERSIC_ELLIPSE'])
32000 samples per node
2
Process 0 global devices : [cuda(id=0), cuda(id=1), cuda(id=2), cuda(id=3)]
Process 0 local devices : [cuda(id=0), cuda(id=1)]
Process 0 rank: 0 out of 2
1722992564.533419
20 (['EPL', 'SHEAR'], ['SERSIC_ELLIPSE'], ['SERSIC_ELLIPSE'])
32000 samples per node
2
  0%|                                                                                                                                                                                                     | 0/350 [00:00<?, ?it/s]2024-08-06 18:03:00.448424: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng36{k2=5,k13=1,k14=3,k18=1,k23=0} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
  0%|                                                                                                                                                                                                     | 0/350 [00:00<?, ?it/s]2024-08-06 18:03:00.511540: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng36{k2=5,k13=1,k14=3,k18=1,k23=0} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:01.373647: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.925327367s
Trying algorithm eng36{k2=5,k13=1,k14=3,k18=1,k23=0} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:01.443587: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.932144284s
Trying algorithm eng36{k2=5,k13=1,k14=3,k18=1,k23=0} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:02.373780: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng35{k2=1,k5=2,k14=5} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:02.443728: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng35{k2=1,k5=2,k14=5} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:02.993027: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.61933756s
Trying algorithm eng35{k2=1,k5=2,k14=5} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:03.063006: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.619376343s
Trying algorithm eng35{k2=1,k5=2,k14=5} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:03.993132: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=4,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:04.063136: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=4,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:04.210073: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.217019725s
Trying algorithm eng46{k2=4,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:04.280114: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.217079584s
Trying algorithm eng46{k2=4,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:05.210175: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=7,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:05.280237: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=7,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:09.085050: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 4.87494457s
Trying algorithm eng46{k2=7,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:09.155152: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 4.87500383s
Trying algorithm eng46{k2=7,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:10.257349: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=5,k5=3,k14=4} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:10.347325: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=5,k5=3,k14=4} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:12.980658: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.723403301s
Trying algorithm eng46{k2=5,k5=3,k14=4} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:13.070742: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.723500647s
Trying algorithm eng46{k2=5,k5=3,k14=4} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:14.331915: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=1,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:14.421136: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=1,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:16.391368: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.059528248s
Trying algorithm eng46{k2=1,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:16.480520: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 3.059499081s
Trying algorithm eng46{k2=1,k5=3,k14=2} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:17.456796: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=0,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:17.545192: E external/xla/xla/service/slow_operation_alarm.cc:65] Trying algorithm eng46{k2=0,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:18.267538: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.810818555s
Trying algorithm eng46{k2=0,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:18.355855: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 1.810781755s
Trying algorithm eng46{k2=0,k5=2,k14=3} for conv (f32[16000,2,60,60]{3,2,1,0}, u8[0]{0}) custom-call(f32[16000,2,60,60]{3,2,1,0}, f32[2,1,13,13]{3,2,1,0}), window={size=13x13 pad=6_6x6_6}, dim_labels=bf01_oi01->bf01, feature_group_count=2, custom_call_target="__cudnn$convForward", backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2024-08-06 18:03:19.244998: W external/xla/xla/service/hlo_rematerialization.cc:3005] Can't reduce memory use below 28.06GiB (30134493183 bytes) by rematerialization; only reduced to 47.76GiB (51284523448 bytes), down from 49.26GiB (52897323816 bytes) originally
2024-08-06 18:03:19.372018: W external/xla/xla/service/hlo_rematerialization.cc:3005] Can't reduce memory use below 28.06GiB (30134493183 bytes) by rematerialization; only reduced to 47.76GiB (51284523448 bytes), down from 49.26GiB (52897323816 bytes) originally
2024-08-06 18:03:32.461836: W external/xla/xla/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 48.30GiB (rounded to 51860487680)requested by op 
2024-08-06 18:03:32.462023: W external/xla/xla/tsl/framework/bfc_allocator.cc:494] **__________________________________________________________________________________________________
E0806 18:03:32.462048 2021780 pjrt_stream_executor_client.cc:2985] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 51860487528 bytes.
2024-08-06 18:03:32.514683: W external/xla/xla/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 48.30GiB (rounded to 51860487680)requested by op 
2024-08-06 18:03:32.514769: W external/xla/xla/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0806 18:03:32.514785 2021782 pjrt_stream_executor_client.cc:2985] Execution of replica 1 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 51860487528 bytes.
  0%|                                                                                                                                                                                                     | 0/350 [00:43<?, ?it/s]
Traceback (most recent call last):
  File "/global/homes/s/seanjx/gigalens/testetc/nanolens.py", line 118, in <module>
    map_estimate, chi = model_seq.MAP(opt, n_samples=n_samples_bs,num_steps=350,seed=0)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/homes/s/seanjx/gigalens/srctest/gigalens/jax/inference.py", line 72, in MAP
    loss, params, opt_state = update(params, opt_state)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/homes/s/seanjx/gigalens/srctest/gigalens/jax/inference.py", line 61, in update
    (_, chisq), grads = loss_and_grad(splt_params)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 51860487528 bytes.: while running replica 0 and partition 0 of a replicated computation (other replicas may have failed as well).
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
2024-08-06 18:03:32.572755: W external/xla/xla/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_0_bfc) ran out of memory trying to allocate 48.30GiB (rounded to 51860487680)requested by op 
2024-08-06 18:03:32.572942: W external/xla/xla/tsl/framework/bfc_allocator.cc:494] **__________________________________________________________________________________________________
E0806 18:03:32.572966 1253476 pjrt_stream_executor_client.cc:2985] Execution of replica 2 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 51860487528 bytes.
2024-08-06 18:03:32.630192: W external/xla/xla/tsl/framework/bfc_allocator.cc:482] Allocator (GPU_1_bfc) ran out of memory trying to allocate 48.30GiB (rounded to 51860487680)requested by op 
2024-08-06 18:03:32.630276: W external/xla/xla/tsl/framework/bfc_allocator.cc:494] *___________________________________________________________________________________________________
E0806 18:03:32.630292 1253478 pjrt_stream_executor_client.cc:2985] Execution of replica 3 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 51860487528 bytes.
  0%|                                                                                                                                                                                                     | 0/350 [00:44<?, ?it/s]
Traceback (most recent call last):
  File "/global/homes/s/seanjx/gigalens/testetc/nanolens.py", line 118, in <module>
    map_estimate, chi = model_seq.MAP(opt, n_samples=n_samples_bs,num_steps=350,seed=0)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/homes/s/seanjx/gigalens/srctest/gigalens/jax/inference.py", line 72, in MAP
    loss, params, opt_state = update(params, opt_state)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/global/homes/s/seanjx/gigalens/srctest/gigalens/jax/inference.py", line 61, in update
    (_, chisq), grads = loss_and_grad(splt_params)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 51860487528 bytes.: while running replica 2 and partition 0 of a replicated computation (other replicas may have failed as well).
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
srun: error: nid003932: task 1: Exited with exit code 1
srun: Terminating StepId=29126969.0
srun: error: nid003256: task 0: Exited with exit code 1
